<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تقارير التقييمات | YLY</title>
  <!-- Bootstrap RTL -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Cairo Font -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-color: #2b68ff;
      --primary-hover: #1c4de1;
      --accent-color: #ffc107;
      --text-color: #fff;
      --bg-overlay: rgba(0, 0, 50, 0.4);
      --form-bg: rgba(255, 255, 255, 0.1);
      --input-bg: rgba(255,255,255,0.2);
      --input-hover: rgba(255,255,255,0.3);
      --border-radius: 14px;
      --card-bg: rgba(255, 255, 255, 0.08);
      --success-color: #28a745;
      --danger-color: #dc3545;
      --warning-color: #fd7e14;
      --info-color: #17a2b8;
    }
    
    /* إصلاح المسافة العلوية */
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      background: url('./assets/bg-space.jpg.png') no-repeat center center fixed;
      background-size: cover;
      color: var(--text-color);
      min-height: 100vh;
    }
    
    .overlay {
      backdrop-filter: blur(10px);
      background-color: var(--bg-overlay);
      width: 100vw;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
    }
    
    /* إصلاح الجزيئات المتحركة */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    
    .particle {
      position: absolute;
      background-color: rgba(255, 255, 255, 0.6);
      border-radius: 50%;
      animation: float-up linear infinite;
    }
    
    @keyframes float-up {
      0% {
        transform: translateY(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh);
        opacity: 0;
      }
    }
    
    /* تعديلات التصميم الأصلي */
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 30px;
      background: rgba(0, 0, 0, 0.3);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .logo-section img {
      height: 50px;
      transition: transform 0.3s;
      cursor: pointer;
    }
    
    .logo-section img:hover {
      transform: scale(1.05);
    }
    
    .season-title {
      font-size: 1.4em;
      font-weight: 700;
      color: var(--accent-color);
      cursor: pointer;
    }
    
    .user-section {
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
    }
    
    .language-toggle {
      background: rgba(255,255,255,0.2);
      padding: 8px 15px;
      border-radius: var(--border-radius);
      color: white;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      border: 1px solid rgba(255,255,255,0.3);
    }
    
    .language-toggle:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      object-fit: cover;
      cursor: pointer;
      border: 2px solid var(--accent-color);
      transition: all 0.3s;
    }
    
    .user-avatar:hover {
      transform: scale(1.1);
    }
    
    .user-dropdown {
      position: absolute;
      top: 60px;
      left: 0;
      background: rgba(0, 0, 0, 0.9);
      border-radius: var(--border-radius);
      padding: 20px;
      width: 250px;
      display: none;
      box-shadow: 0 10px 25px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 101;
    }
    
    .user-dropdown.show {
      display: block;
      animation: fadeIn 0.3s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .user-info {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .user-dropdown-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--primary-color);
    }
    
    .user-name {
      font-size: 1.2em;
      font-weight: 600;
    }
    
    .user-role {
      color: var(--accent-color);
      font-size: 0.9em;
    }
    
    .dropdown-btn {
      width: 100%;
      padding: 10px;
      margin: 5px 0;
      border-radius: var(--border-radius);
      background: rgba(255,255,255,0.1);
      border: none;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .dropdown-btn:hover {
      background: var(--primary-color);
    }
    
    /* شريط التنقل */
    .nav-bar {
      display: flex;
      justify-content: center;
      background: rgba(0, 0, 0, 0.2);
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .nav-link {
      padding: 10px 20px;
      margin: 0 5px;
      color: white;
      text-decoration: none;
      font-weight: 600;
      border-radius: var(--border-radius);
      transition: all 0.3s;
      position: relative;
      cursor: pointer;
    }
    
    .nav-link:hover, .nav-link.active {
      background: var(--primary-color);
    }
    
    .nav-link:hover::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 5px solid var(--primary-color);
    }
    
    /* المحتوى الرئيسي */
    .main-content {
      padding: 30px;
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .section-title {
      font-size: 1.8em;
      margin-bottom: 25px;
      color: var(--accent-color);
      display: flex;
      align-items: center;
      gap: 15px;
      cursor: pointer;
    }
    
    .section-title i {
      font-size: 1.2em;
    }
    
    /* بطاقات الإحصائيات */
    .stats-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }
    
    .stat-card .stat-title {
      font-size: 0.9em;
      color: rgba(255,255,255,0.7);
      margin-bottom: 10px;
    }
    
    .stat-card .stat-value {
      font-size: 2em;
      font-weight: 700;
      margin-bottom: 5px;
    }
    
    .stat-card .stat-change {
      font-size: 0.8em;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .stat-card .stat-change.positive {
      color: var(--success-color);
    }
    
    .stat-card .stat-change.negative {
      color: var(--danger-color);
    }
    
    /* الفلاتر - تحسين القوائم المنسدلة */
    .report-filters {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 30px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .filter-row {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }
    
    .filter-group {
      flex: 1;
      min-width: 200px;
      position: relative;
    }
    
    .filter-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--accent-color);
    }
    
    .filter-control {
      width: 100%;
      padding: 10px 12px;
      border-radius: var(--border-radius);
      border: 1px solid rgba(255,255,255,0.2);
      background: var(--input-bg);
      color: white;
      font-family: 'Cairo', sans-serif;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: left 15px center;
      background-size: 12px;
      padding-right: 15px;
      padding-left: 35px;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .filter-control:focus {
      outline: none;
      border-color: var(--accent-color);
      background-color: var(--input-hover);
      box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.25);
    }
    
    .filter-control option {
      background-color: #2a3042;
      color: white;
    }
    
    .filter-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 15px;
    }
    
    /* الرسوم البيانية */
    .report-section {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 30px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .section-title {
      font-size: 1.3em;
      color: var(--accent-color);
      margin: 0;
    }
    
    .chart-container {
      position: relative;
      height: 350px;
      margin-bottom: 30px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: var(--border-radius);
      padding: 15px;
      cursor: pointer;
    }
    
    /* الجداول */
    .evaluation-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .evaluation-table th, 
    .evaluation-table td {
      padding: 12px 15px;
      text-align: right;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .evaluation-table th {
      background: rgba(0,0,0,0.3);
      font-weight: 600;
      color: var(--accent-color);
    }
    
    .evaluation-table tr:hover {
      background: rgba(255,255,255,0.05);
    }
    
    .grade-A { color: var(--success-color); font-weight: 600; }
    .grade-B { color: #a3d56e; font-weight: 600; }
    .grade-C { color: var(--warning-color); font-weight: 600; }
    .grade-D { color: #ff9f43; font-weight: 600; }
    .grade-F { color: var(--danger-color); font-weight: 600; }
    
    /* التصنيفات */
    .badge {
      font-weight: 600;
      padding: 5px 10px;
      border-radius: 50px;
      font-size: 0.8em;
      margin-right: 5px;
    }
    
    .badge-leader {
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      color: #333;
    }
    
    .badge-new {
      background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
      color: #333;
    }
    
    .badge-improved {
      background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
      color: #333;
    }
    
    /* الترقيم */
    .pagination {
      display: flex;
      justify-content: center;
      margin-top: 20px;
      gap: 10px;
    }
    
    .page-btn {
      background: rgba(255,255,255,0.1);
      border: none;
      color: white;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .page-btn.active {
      background: var(--primary-color);
    }
    
    .page-btn:hover:not(.active) {
      background: rgba(255,255,255,0.2);
    }
    
    /* أزرار التحكم */
    .control-btn {
      padding: 10px 15px;
      border-radius: var(--border-radius);
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9em;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: var(--primary-hover);
    }
    
    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }
    
    .btn-success {
      background-color: var(--success-color);
      color: white;
    }
    
    .btn-danger {
      background-color: var(--danger-color);
      color: white;
    }
    
    .btn-warning {
      background-color: var(--warning-color);
      color: white;
    }
    
    .btn-info {
      background-color: var(--info-color);
      color: white;
    }
    
    .btn-whatsapp {
      background-color: #25D366;
      color: white;
    }
    
    .btn-whatsapp:hover {
      background-color: #128C7E;
    }
    
    /* مجموعة الأزرار */
    .btn-group {
      display: flex;
      gap: 10px;
    }
    
    /* شخصية بيلو */
    .bilo-container {
      position: fixed;
      bottom: 30px;
      left: 30px;
      z-index: 99;
    }
    
    .bilo-img {
      width: 120px;
      cursor: pointer;
      transition: all 0.3s;
      filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));
    }
    
    .bilo-img:hover {
      transform: scale(1.1);
    }
    
    .bilo-speech {
      position: absolute;
      bottom: 140px;
      left: 50px;
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: var(--border-radius);
      padding: 15px;
      width: 250px;
      font-size: 0.95em;
      display: none;
      backdrop-filter: blur(5px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    
    .bilo-speech.show {
      display: block;
      animation: appear 0.3s ease-out;
    }
    
    .bilo-speech::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 30px;
      border-width: 10px 10px 0;
      border-style: solid;
      border-color: rgba(255, 255, 255, 0.15) transparent;
    }
    
    @keyframes appear {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* البحث - تحسينات جديدة */
    .search-box {
      position: relative;
      margin-bottom: 20px;
      max-width: 500px;
      margin-right: auto;
      margin-left: auto;
    }
    
    .search-box input {
      width: 100%;
      padding: 12px 45px 12px 15px;
      border-radius: var(--border-radius);
      border: 1px solid rgba(255,255,255,0.2);
      background: var(--input-bg);
      color: white;
      font-family: 'Cairo', sans-serif;
      transition: all 0.3s;
      font-size: 1em;
    }
    
    .search-box input:focus {
      outline: none;
      border-color: var(--accent-color);
      background: var(--input-hover);
      box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.25);
    }
    
    .search-box i {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255,255,255,0.7);
      transition: all 0.3s;
    }
    
    .search-box input:focus + i {
      color: var(--accent-color);
    }
    
    .search-box .search-clear {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255,255,255,0.7);
      cursor: pointer;
      display: none;
    }
    
    .search-box input:not(:placeholder-shown) + i + .search-clear {
      display: block;
    }
    
    /* نافذة تفاصيل التقييم */
    .evaluation-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .evaluation-modal.show {
      display: flex;
      opacity: 1;
    }
    
    .modal-content {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 700px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 30px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      position: relative;
      animation: modalFadeIn 0.3s;
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .modal-title {
      font-size: 1.5em;
      color: var(--accent-color);
      margin: 0;
    }
    
    .close-modal {
      background: none;
      border: none;
      color: white;
      font-size: 1.5em;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .close-modal:hover {
      color: var(--danger-color);
      transform: rotate(90deg);
    }
    
    .volunteer-info {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .volunteer-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--primary-color);
    }
    
    .volunteer-details h3 {
      margin: 0 0 5px 0;
      font-size: 1.3em;
    }
    
    .volunteer-details p {
      margin: 5px 0;
      color: rgba(255,255,255,0.8);
    }
    
    .evaluation-details {
      margin-top: 25px;
    }
    
    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .detail-label {
      color: rgba(255,255,255,0.7);
      font-weight: 600;
    }
    
    .detail-value {
      font-weight: 600;
    }
    
    .detail-value.grade-A { color: var(--success-color); }
    .detail-value.grade-B { color: #a3d56e; }
    .detail-value.grade-C { color: var(--warning-color); }
    .detail-value.grade-D { color: #ff9f43; }
    .detail-value.grade-F { color: var(--danger-color); }
    
    .modal-footer {
      margin-top: 30px;
      display: flex;
      justify-content: flex-end;
      gap: 15px;
    }
    
    .comments-section {
      margin-top: 25px;
    }
    
    .comments-title {
      font-size: 1.2em;
      color: var(--accent-color);
      margin-bottom: 15px;
    }
    
    .comment-box {
      background: rgba(0,0,0,0.3);
      border-radius: var(--border-radius);
      padding: 15px;
      margin-bottom: 15px;
    }
    
    .comment-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 0.9em;
      color: rgba(255,255,255,0.7);
    }
    
    .comment-text {
      line-height: 1.6;
    }
    
    /* نافذة أعلى تقييم */
    .top-evaluation-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .top-evaluation-modal.show {
      display: flex;
      opacity: 1;
    }
    
    .top-evaluation-content {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 30px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      position: relative;
      animation: modalFadeIn 0.3s;
    }
    
    .top-evaluation-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .top-evaluation-title {
      font-size: 1.5em;
      color: var(--accent-color);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .top-evaluation-title i {
      color: var(--accent-color);
    }
    
    .top-evaluation-body {
      margin-top: 20px;
    }
    
    .top-evaluation-message {
      background: rgba(0,0,0,0.3);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      position: relative;
    }
    
    .top-evaluation-message::before {
      content: '"';
      font-size: 4em;
      color: rgba(255,255,255,0.1);
      position: absolute;
      top: 10px;
      left: 15px;
      line-height: 1;
    }
    
    .top-evaluation-message p {
      font-size: 1.1em;
      line-height: 1.6;
      margin: 0;
      position: relative;
      z-index: 1;
    }
    
    .top-evaluation-footer {
      margin-top: 30px;
      display: flex;
      justify-content: flex-end;
      gap: 15px;
    }
    
    /* نافذة المتطوعين المتميزين */
    .top-volunteers-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .top-volunteers-modal.show {
      display: flex;
      opacity: 1;
    }
    
    .top-volunteers-content {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 30px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      position: relative;
      animation: modalFadeIn 0.3s;
    }
    
    .top-volunteers-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .top-volunteers-title {
      font-size: 1.5em;
      color: var(--accent-color);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .top-volunteers-title i {
      color: var(--accent-color);
    }
    
    .top-volunteers-body {
      margin-top: 20px;
    }
    
    .top-volunteers-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .top-volunteer-card {
      background: rgba(0,0,0,0.3);
      border-radius: var(--border-radius);
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      transition: all 0.3s;
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .top-volunteer-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .top-volunteer-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--success-color);
    }
    
    .top-volunteer-details h4 {
      margin: 0 0 5px 0;
      font-size: 1.1em;
    }
    
    .top-volunteer-details p {
      margin: 5px 0;
      font-size: 0.9em;
      color: rgba(255,255,255,0.8);
    }
    
    .top-volunteer-score {
      font-weight: 700;
      color: var(--success-color);
    }
    
    .top-volunteers-footer {
      margin-top: 30px;
      display: flex;
      justify-content: space-between;
      gap: 15px;
    }
    
    /* التجاوب مع أحجام الشاشات */
    @media (max-width: 992px) {
      .stats-cards {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
      
      .filter-row {
        flex-direction: column;
        gap: 15px;
      }
      
      .filter-group {
        min-width: 100%;
      }
      
      .top-volunteers-list {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
    }
    
    @media (max-width: 768px) {
      .top-bar {
        padding: 10px 15px;
      }
      
      .logo-section img {
        height: 40px;
      }
      
      .season-title {
        font-size: 1.1em;
      }
      
      .user-avatar {
        width: 40px;
        height: 40px;
      }
      
      .nav-bar {
        justify-content: flex-start;
        overflow-x: auto;
        padding: 10px 5px;
      }
      
      .nav-link {
        padding: 8px 15px;
        font-size: 0.9em;
      }
      
      .main-content {
        padding: 20px 15px;
      }
      
      .bilo-container {
        display: none;
      }
      
      .btn-group {
        flex-direction: column;
        width: 100%;
      }
      
      .btn-group .control-btn {
        width: 100%;
      }
      
      .volunteer-info {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .modal-footer, .top-evaluation-footer, .top-volunteers-footer {
        flex-direction: column;
      }
      
      .modal-footer .control-btn,
      .top-evaluation-footer .control-btn,
      .top-volunteers-footer .control-btn {
        width: 100%;
      }
    }
    
    @media (max-width: 576px) {
      .stats-cards {
        grid-template-columns: 1fr;
      }
      
      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }
      
      .detail-row {
        flex-direction: column;
        gap: 5px;
      }
      
      .top-evaluation-title, .top-volunteers-title {
        font-size: 1.2em;
      }
      
      .top-volunteers-list {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
<div class="overlay"></div>
<div class="particles" id="particles"></div>

<!-- الشريط العلوي -->
<div class="top-bar">
  <div class="logo-section">
    <img src="assets/logo-ministry.png" alt="وزارة الشباب والرياضة">
    <img src="assets/logo-yly.png" alt="YLY">
    <div class="season-title">YLY - PORT SAID SEASON <span id="season-number">7</span></div>
  </div>
  
  <div class="user-section">
    <div class="language-toggle" onclick="toggleLanguage()">
      <i class="fas fa-language"></i>
      <span>العربية / English</span>
    </div>
    
    <img src="assets/SAAD.jpg" alt="صورة المستخدم" class="user-avatar" id="user-avatar">
    
    <div class="user-dropdown" id="user-dropdown">
      <div class="user-info">
        <img src="assets/SAAD.jpg" alt="صورة المستخدم" class="user-dropdown-avatar">
        <div class="user-name" id="dropdown-username">سعد المرجاوي</div>
        <div class="user-role" id="dropdown-userrole">مدير النظام</div>
      </div>
      
      <button class="dropdown-btn" onclick="openSettings()">
        <i class="fas fa-cog"></i> الإعدادات
      </button>
      <button class="dropdown-btn" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
      </button>
    </div>
  </div>
</div>

<!-- شريط التنقل -->
<div class="nav-bar">
  <a href="home.html" class="nav-link"><i class="fas fa-home"></i> الصفحة الرئيسية</a>
  <a href="volunteers.html" class="nav-link"><i class="fas fa-users"></i> إدارة المتطوعين</a>
  <a href="evaluations.html" class="nav-link"><i class="fas fa-star"></i>إدارة التقييمات </a>
  <a href="reports.html" class="nav-link active"><i class="fas fa-chart-bar"></i> التقارير</a>
  <a href="role.system.html" class="nav-link"><i class="fas fa-info-circle"></i> قواعد النظام</a>
  <a href="support.html" class="nav-link"><i class="fas fa-envelope"></i> تواصل معنا</a>
</div>

<!-- المحتوى الرئيسي -->
<div class="main-content">
  <div class="section-title" id="main-section-title">
    <i class="fas fa-chart-bar"></i>
    <h2>تقارير التقييمات</h2>
  </div>

  <!-- بطاقات الإحصائيات السريعة -->
  <div class="stats-cards">
    <div class="stat-card" id="total-evaluations-card">
      <div class="stat-title">إجمالي التقييمات</div>
      <div class="stat-value">1,248</div>
      <div class="stat-change positive">
        <i class="fas fa-arrow-up"></i> 12% عن الشهر الماضي
      </div>
    </div>
    
    <div class="stat-card" id="average-score-card">
      <div class="stat-title">متوسط التقييم</div>
      <div class="stat-value">84.5</div>
      <div class="stat-change positive">
        <i class="fas fa-arrow-up"></i> 3.2% عن الشهر الماضي
      </div>
    </div>
    
    <div class="stat-card" id="highest-score-card" onclick="showTopEvaluation()">
      <div class="stat-title">أعلى تقييم</div>
      <div class="stat-value">98</div>
      <div class="stat-title">ريم عاشور - لجنة PR</div>
    </div>
    
    <div class="stat-card" id="top-volunteers-card" onclick="showTopVolunteers()">
      <div class="stat-title">المتطوعون المتميزون</div>
      <div class="stat-value">37</div>
      <div class="stat-title">بتقدير ممتاز (A)</div>
    </div>
  </div>

  <!-- فلاتر التقرير -->
  <div class="report-filters" id="report-filters">
    <div class="filter-row">
      <div class="filter-group">
        <label for="report-type">نوع التقرير</label>
        <select id="report-type" class="filter-control">
          <option value="monthly">تقرير شهري</option>
          <option value="committee">حسب اللجنة</option>
          <option value="volunteer">تقرير متطوع</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="time-period">الفترة الزمنية</label>
        <select id="time-period" class="filter-control">
          <option value="current-month">الشهر الحالي</option>
          <option value="last-month">الشهر الماضي</option>
          <option value="last-3months" selected>آخر 3 أشهر</option>
          <option value="season">الموسم كامل</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="committee-filter">اللجنة</label>
        <select id="committee-filter" class="filter-control">
          <option value="">كل اللجان</option>
          <option value="HR">الموارد البشرية (HR)</option>
          <option value="PR">العلاقات العامة (PR)</option>
          <option value="OR">التنظيم (OR)</option>
          <option value="SM">إدارة المواقع (SM)</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="grade-filter">التقدير</label>
        <select id="grade-filter" class="filter-control">
          <option value="">كل التقديرات</option>
          <option value="A">ممتاز (A)</option>
          <option value="B">جيد جداً (B)</option>
          <option value="C">جيد (C)</option>
          <option value="D">مقبول (D)</option>
          <option value="F">ضعيف (F)</option>
        </select>
      </div>
    </div>
    
    <div class="filter-actions">
      <button class="control-btn btn-secondary" id="apply-filters-btn">
        <i class="fas fa-filter"></i> تطبيق الفلاتر
      </button>
      <button class="control-btn btn-danger" id="reset-filters-btn">
        <i class="fas fa-redo"></i> إعادة تعيين
      </button>
    </div>
  </div>

  <!-- البحث - تم تحسينه -->
  <div class="search-box">
    <input type="text" id="search-input" placeholder="ابحث عن متطوع أو لجنة...">
    <i class="fas fa-search"></i>
    <span class="search-clear" id="search-clear"><i class="fas fa-times"></i></span>
  </div>

  <!-- الرسوم البيانية -->
  <div class="report-section">
    <div class="section-header">
      <h3 class="section-title">توزيع التقييمات</h3>
      <button class="control-btn btn-primary" id="share-charts-btn">
        <i class="fas fa-share-alt"></i> مشاركة
      </button>
    </div>
    
    <div class="chart-container" id="grades-chart-container">
      <canvas id="gradesChart"></canvas>
    </div>
    
    <div class="chart-container" id="trend-chart-container">
      <canvas id="trendChart"></canvas>
    </div>
  </div>

  <!-- جدول التقييمات -->
  <div class="report-section">
    <div class="section-header">
      <h3 class="section-title">تفاصيل التقييمات</h3>
      <div class="btn-group">
        <button class="control-btn btn-primary" id="print-table-btn">
          <i class="fas fa-print"></i> طباعة
        </button>
        <button class="control-btn btn-success" id="export-excel-btn">
          <i class="fas fa-file-excel"></i> Excel
        </button>
      </div>
    </div>
    
    <div style="overflow-x: auto;">
      <table class="evaluation-table" id="evaluation-table">
        <thead>
          <tr>
            <th>#</th>
            <th>اسم المتطوع</th>
            <th>اللجنة</th>
            <th>شهر التقييم</th>
            <th>المجموع</th>
            <th>التقدير</th>
            <th>المهام</th>
            <th>الفعاليات</th>
            <th>الاجتماعات</th>
            <th>إجراءات</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>
              ريم عاشور
              <span class="badge badge-leader">قائد فريق</span>
            </td>
            <td>PR</td>
            <td>فبراير 2025</td>
            <td>98</td>
            <td class="grade-A">ممتاز (A)</td>
            <td>28/30</td>
            <td>20/20</td>
            <td>20/20</td>
            <td>
              <button class="control-btn btn-info" onclick="showEvaluationDetails(1)">
                <i class="fas fa-eye"></i> عرض
              </button>
            </td>
          </tr>
          <tr>
            <td>2</td>
            <td>
              محمد أحمد
              <span class="badge badge-improved">الأكثر تحسناً</span>
            </td>
            <td>HR</td>
            <td>فبراير 2025</td>
            <td>87</td>
            <td class="grade-B">جيد جداً (B)</td>
            <td>25/30</td>
            <td>18/20</td>
            <td>19/20</td>
            <td>
              <button class="control-btn btn-info" onclick="showEvaluationDetails(2)">
                <i class="fas fa-eye"></i> عرض
              </button>
            </td>
          </tr>
          <tr>
            <td>3</td>
            <td>أحمد محمد</td>
            <td>OR</td>
            <td>فبراير 2025</td>
            <td>76</td>
            <td class="grade-C">جيد (C)</td>
            <td>22/30</td>
            <td>15/20</td>
            <td>16/20</td>
            <td>
              <button class="control-btn btn-info" onclick="showEvaluationDetails(3)">
                <i class="fas fa-eye"></i> عرض
              </button>
            </td>
          </tr>
          <tr>
            <td>4</td>
            <td>
              ياسمين وائل
              <span class="badge badge-new">جديد</span>
            </td>
            <td>SM</td>
            <td>فبراير 2025</td>
            <td>92</td>
            <td class="grade-A">ممتاز (A)</td>
            <td>27/30</td>
            <td>19/20</td>
            <td>20/20</td>
            <td>
              <button class="control-btn btn-info" onclick="showEvaluationDetails(4)">
                <i class="fas fa-eye"></i> عرض
              </button>
            </td>
          </tr>
          <tr>
            <td>5</td>
            <td>علي محمود</td>
            <td>PR</td>
            <td>يناير 2025</td>
            <td>68</td>
            <td class="grade-D">مقبول (D)</td>
            <td>18/30</td>
            <td>14/20</td>
            <td>15/20</td>
            <td>
              <button class="control-btn btn-info" onclick="showEvaluationDetails(5)">
                <i class="fas fa-eye"></i> عرض
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="pagination">
      <button class="page-btn"><i class="fas fa-angle-double-right"></i></button>
      <button class="page-btn">1</button>
      <button class="page-btn active">2</button>
      <button class="page-btn">3</button>
      <button class="page-btn"><i class="fas fa-angle-double-left"></i></button>
    </div>
  </div>
</div>

<!-- شخصية بيلو -->
<div class="bilo-container">
  <img src="assets/bilo-shogaa.png" alt="بيلو" class="bilo-img" id="bilo-img">
  <div class="bilo-speech" id="bilo-speech">مرحباً بك في قسم التقارير! هنا يمكنك تحليل أداء المتطوعين واتخاذ قرارات مدروسة.</div>
</div>

<!-- نافذة تفاصيل التقييم -->
<div class="evaluation-modal" id="evaluation-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">تفاصيل التقييم</h3>
      <button class="close-modal" onclick="closeEvaluationDetails()">&times;</button>
    </div>
    
    <div class="volunteer-info">
      <img src="assets/volunteer1.jpg" alt="صورة المتطوع" class="volunteer-avatar" id="modal-avatar">
      <div class="volunteer-details">
        <h3 id="modal-volunteer-name">ريم عاشور</h3>
        <p id="modal-committee">اللجنة: العلاقات العامة (PR)</p>
        <p id="modal-evaluation-month">شهر التقييم: فبراير 2025</p>
      </div>
    </div>
    
    <div class="evaluation-details">
      <div class="detail-row">
        <span class="detail-label">المجموع الكلي</span>
        <span class="detail-value grade-A" id="modal-total-score">98</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">التقدير</span>
        <span class="detail-value grade-A" id="modal-grade">ممتاز (A)</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">إنجاز المهام</span>
        <span class="detail-value" id="modal-tasks">28/30</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">المشاركة في الفعاليات</span>
        <span class="detail-value" id="modal-events">20/20</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">حضور الاجتماعات</span>
        <span class="detail-value" id="modal-meetings">20/20</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">الالتزام بالمواعيد</span>
        <span class="detail-value" id="modal-punctuality">10/10</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">روح الفريق</span>
        <span class="detail-value" id="modal-teamwork">10/10</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">الإبداع والابتكار</span>
        <span class="detail-value" id="modal-creativity">10/10</span>
      </div>
    </div>
    
    <div class="comments-section">
      <h4 class="comments-title">ملاحظات التقييم</h4>
      <div class="comment-box">
        <div class="comment-header">
          <span>المقيّم: سعد المرجاوي</span>
          <span>15 فبراير 2025</span>
        </div>
        <div class="comment-text" id="modal-comments">
          أداء ممتاز في جميع النواحي، أظهرت التزاماً كبيراً بالمهام الموكلة إليها وقدرة عالية على العمل تحت الضغط. ساهمت بشكل فعال في نجاح فعاليات اللجنة وكانت دائماً ما تقدم أفكاراً إبداعية لحل المشكلات.
        </div>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="control-btn btn-whatsapp" onclick="shareOnWhatsApp()">
        <i class="fab fa-whatsapp"></i> مشاركة عبر واتساب
      </button>
      <button class="control-btn btn-primary" onclick="printEvaluation()">
        <i class="fas fa-print"></i> طباعة التقييم
      </button>
      <button class="control-btn btn-secondary" onclick="closeEvaluationDetails()">
        <i class="fas fa-times"></i> إغلاق
      </button>
    </div>
  </div>
</div>

<!-- نافذة أعلى تقييم -->
<div class="top-evaluation-modal" id="top-evaluation-modal">
  <div class="top-evaluation-content">
    <div class="top-evaluation-header">
      <h3 class="top-evaluation-title">
        <i class="fas fa-trophy"></i> أعلى تقييم في النظام
      </h3>
      <button class="close-modal" onclick="closeTopEvaluation()">&times;</button>
    </div>
    
    <div class="volunteer-info">
      <img src="assets/volunteer1.jpg" alt="صورة المتطوع" class="volunteer-avatar">
      <div class="volunteer-details">
        <h3>ريم عاشور</h3>
        <p>اللجنة: العلاقات العامة (PR)</p>
        <p>شهر التقييم: فبراير 2025</p>
        <p>التقدير: <span class="grade-A">ممتاز (A) - 98/100</span></p>
      </div>
    </div>
    
    <div class="top-evaluation-body">
      <div class="top-evaluation-message">
        <p>مبروك يا ريم! أنت صاحبة أعلى تقييم في النظام حتى الآن. أداؤك المتميز في جميع النواحي كان مثالاً يحتذى به لجميع المتطوعين. استمر في هذا التميز، ونحن نقدر جهودك الكبيرة في لجنة العلاقات العامة.</p>
      </div>
      
      <div class="evaluation-details">
        <div class="detail-row">
          <span class="detail-label">إنجاز المهام</span>
          <span class="detail-value">28/30</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">المشاركة في الفعاليات</span>
          <span class="detail-value">20/20</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">حضور الاجتماعات</span>
          <span class="detail-value">20/20</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">الالتزام بالمواعيد</span>
          <span class="detail-value">10/10</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">روح الفريق</span>
          <span class="detail-value">10/10</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">الإبداع والابتكار</span>
          <span class="detail-value">10/10</span>
        </div>
      </div>
    </div>
    
    <div class="top-evaluation-footer">
      <button class="control-btn btn-whatsapp" onclick="sendThankYouMessage()">
        <i class="fab fa-whatsapp"></i> إرسال رسالة شكر من بيلو
      </button>
      <button class="control-btn btn-secondary" onclick="closeTopEvaluation()">
        <i class="fas fa-times"></i> إغلاق
      </button>
    </div>
  </div>
</div>

<!-- نافذة المتطوعين المتميزين -->
<div class="top-volunteers-modal" id="top-volunteers-modal">
  <div class="top-volunteers-content">
    <div class="top-volunteers-header">
      <h3 class="top-volunteers-title">
        <i class="fas fa-star"></i> المتطوعون المتميزون
      </h3>
      <button class="close-modal" onclick="closeTopVolunteers()">&times;</button>
    </div>
    
    <div class="top-volunteers-body">
      <p>هؤلاء المتطوعون حصلوا على تقدير ممتاز (A) في تقييماتهم. نقدم لهم كل التقدير والشكر على جهودهم المتميزة.</p>
      
      <div class="top-volunteers-list" id="top-volunteers-list">
        <!-- سيتم تعبئة هذه القائمة عبر JavaScript -->
      </div>
    </div>
    
    <div class="top-volunteers-footer">
      <button class="control-btn btn-whatsapp" onclick="sendGroupCongratulation()">
        <i class="fab fa-whatsapp"></i> تهنئة جماعية عبر واتساب
      </button>
      <button class="control-btn btn-secondary" onclick="closeTopVolunteers()">
        <i class="fas fa-times"></i> إغلاق
      </button>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // بيانات المستخدم
  const currentUser = {
    name: "سعد المرجاوي",
    role: "مدير النظام",
    avatar: "assets/SAAD.jpg",
    season: 7
  };

  // بيانات التقييمات
  const evaluationData = {
    grades: {
      labels: ['ممتاز (A)', 'جيد جداً (B)', 'جيد (C)', 'مقبول (D)', 'ضعيف (F)'],
      data: [37, 84, 62, 23, 5]
    },
    trend: {
      labels: ['ديسمبر', 'يناير', 'فبراير'],
      averages: [78.5, 82.3, 84.5]
    }
  };

  // بيانات المتطوعين المتميزين
  const topVolunteers = [
    {
      id: 1,
      name: "ريم عاشور",
      avatar: "assets/volunteer1.jpg",
      committee: "PR",
      committeeName: "العلاقات العامة",
      month: "فبراير 2025",
      score: 98,
      tasks: "28/30",
      events: "20/20",
      meetings: "20/20"
    },
    {
      id: 4,
      name: "ياسمين وائل",
      avatar: "assets/volunteer4.jpg",
      committee: "SM",
      committeeName: "إدارة المواقع",
      month: "فبراير 2025",
      score: 92,
      tasks: "27/30",
      events: "19/20",
      meetings: "20/20"
    },
    {
      id: 6,
      name: "أحمد علي",
      avatar: "assets/volunteer6.jpg",
      committee: "HR",
      committeeName: "الموارد البشرية",
      month: "فبراير 2025",
      score: 95,
      tasks: "29/30",
      events: "19/20",
      meetings: "19/20"
    },
    {
      id: 7,
      name: "سارة محمد",
      avatar: "assets/volunteer7.jpg",
      committee: "OR",
      committeeName: "التنظيم",
      month: "فبراير 2025",
      score: 94,
      tasks: "28/30",
      events: "20/20",
      meetings: "18/20"
    },
    {
      id: 8,
      name: "محمود خالد",
      avatar: "assets/volunteer8.jpg",
      committee: "PR",
      committeeName: "العلاقات العامة",
      month: "فبراير 2025",
      score: 91,
      tasks: "27/30",
      events: "19/20",
      meetings: "19/20"
    },
    {
      id: 9,
      name: "نورا أحمد",
      avatar: "assets/volunteer9.jpg",
      committee: "SM",
      committeeName: "إدارة المواقع",
      month: "فبراير 2025",
      score: 93,
      tasks: "28/30",
      events: "18/20",
      meetings: "20/20"
    }
  ];

  // بيانات تفاصيل التقييمات
  const evaluationsDetails = {
    1: {
      name: "ريم عاشور",
      avatar: "assets/volunteer1.jpg",
      committee: "العلاقات العامة (PR)",
      month: "فبراير 2025",
      total: 98,
      grade: "ممتاز (A)",
      tasks: "28/30",
      events: "20/20",
      meetings: "20/20",
      punctuality: "10/10",
      teamwork: "10/10",
      creativity: "10/10",
      comments: "أداء ممتاز في جميع النواحي، أظهرت التزاماً كبيراً بالمهام الموكلة إليها وقدرة عالية على العمل تحت الضغط. ساهمت بشكل فعال في نجاح فعاليات اللجنة وكانت دائماً ما تقدم أفكاراً إبداعية لحل المشكلات.",
      evaluator: "سعد المرجاوي",
      date: "15 فبراير 2025"
    },
    2: {
      name: "محمد أحمد",
      avatar: "assets/volunteer2.jpg",
      committee: "الموارد البشرية (HR)",
      month: "فبراير 2025",
      total: 87,
      grade: "جيد جداً (B)",
      tasks: "25/30",
      events: "18/20",
      meetings: "19/20",
      punctuality: "9/10",
      teamwork: "9/10",
      creativity: "7/10",
      comments: "أداء جيد جداً مع تحسن ملحوظ عن الشهر الماضي. يحتاج إلى المزيد من الابتكار في حل المشكلات ولكن التزامه بالمواعيد وروح الفريق ممتازة.",
      evaluator: "سعد المرجاوي",
      date: "14 فبراير 2025"
    },
    3: {
      name: "أحمد محمد",
      avatar: "assets/volunteer3.jpg",
      committee: "التنظيم (OR)",
      month: "فبراير 2025",
      total: 76,
      grade: "جيد (C)",
      tasks: "22/30",
      events: "15/20",
      meetings: "16/20",
      punctuality: "8/10",
      teamwork: "7/10",
      creativity: "8/10",
      comments: "أداء جيد مع وجود مجال للتحسين في المشاركة الفعالة في الفعاليات وحضور الاجتماعات. يحتاج إلى بذل المزيد من الجهد في العمل الجماعي.",
      evaluator: "سعد المرجاوي",
      date: "16 فبراير 2025"
    },
    4: {
      name: "ياسمين وائل",
      avatar: "assets/volunteer4.jpg",
      committee: "إدارة المواقع (SM)",
      month: "فبراير 2025",
      total: 92,
      grade: "ممتاز (A)",
      tasks: "27/30",
      events: "19/20",
      meetings: "20/20",
      punctuality: "10/10",
      teamwork: "9/10",
      creativity: "7/10",
      comments: "أداء ممتاز خاصة أنها جديدة في الفريق. أظهرت التزاماً كبيراً وسرعة في التعلم. تحتاج إلى تطوير الجانب الإبداعي أكثر ولكن بشكل عام أداء متميز.",
      evaluator: "سعد المرجاوي",
      date: "17 فبراير 2025"
    },
    5: {
      name: "علي محمود",
      avatar: "assets/volunteer5.jpg",
      committee: "العلاقات العامة (PR)",
      month: "يناير 2025",
      total: 68,
      grade: "مقبول (D)",
      tasks: "18/30",
      events: "14/20",
      meetings: "15/20",
      punctuality: "7/10",
      teamwork: "6/10",
      creativity: "8/10",
      comments: "أداء مقبول مع وجود نقاط ضعف في الالتزام بالمهام وحضور الاجتماعات. يحتاج إلى تحسين كبير في إدارة الوقت والعمل الجماعي.",
      evaluator: "سعد المرجاوي",
      date: "15 يناير 2025"
    }
  };

  // رسائل بيلو لكل قسم
  const biloMessages = {
    "main-section": [
      "مرحباً بك في قسم التقارير! هنا يمكنك تحليل أداء المتطوعين واتخاذ قرارات مدروسة.",
      "يمكنك تصفح تقارير التقييمات الشهرية والسنوية من هنا.",
      "استخدم الفلاتر للعثور على البيانات التي تبحث عنها بسهولة."
    ],
    "total-evaluations": [
      "إجمالي عدد التقييمات المسجلة في النظام.",
      "هذا الرقم يمثل كل التقييمات التي تم تسجيلها حتى الآن.",
      "لاحظ أن عدد التقييمات زاد بنسبة 12% عن الشهر الماضي!"
    ],
    "average-score": [
      "متوسط التقييمات يعطيك فكرة عن الأداء العام للمتطوعين.",
      "المتوسط الحالي هو 84.5 وهو جيد جداً مقارنة بالمعايير.",
      "المتوسط في تحسن مستمر، هذا مؤشر جيد!"
    ],
    "highest-score": [
      "ريم عاشور حققت أعلى تقييم هذا الشهر!",
      "تقييم 98/100 هو إنجاز رائع، يمكنك النقر لرؤية تفاصيل تقييمها.",
      "المتطوعون المتميزون مثل ريم يستحقون التشجيع والمكافأة."
    ],
    "top-volunteers": [
      "37 متطوعاً حصلوا على تقدير ممتاز (A) هذا الشهر.",
      "هؤلاء المتطوعون هم الأكثر تميزاً في أدائهم.",
      "يمكنك تصفية الجدول لعرض فقط المتطوعين المتميزين."
    ],
    "report-filters": [
      "استخدم الفلاتر للعثور على البيانات التي تبحث عنها.",
      "يمكنك تصفية التقييمات حسب اللجنة، الفترة الزمنية، أو التقدير.",
      "اضغط على 'تطبيق الفلاتر' بعد اختيار المعايير المطلوبة."
    ],
    "search-box": [
      "ابحث عن أي متطوع بالاسم أو اللجنة التي يعمل بها.",
      "جرب كتابة جزء من الاسم للعثور على المتطوعين بسرعة.",
      "اضغط على علامة X لمسح البحث والعودة للقائمة الكاملة."
    ],
    "grades-chart": [
      "هذا الرسم يوضح توزيع المتطوعين حسب التقديرات.",
      "يمكنك رؤية عدد المتطوعين في كل فئة تقدير.",
      "الهدف هو زيادة عدد المتطوعين في فئة 'ممتاز' وتقليل 'ضعيف'."
    ],
    "trend-chart": [
      "هذا الرسم يوضح تطور متوسط التقييمات مع الوقت.",
      "المتوسط في تحسن مستمر، هذا مؤشر جيد على تحسن الأداء.",
      "يمكنك مقارنة أداء الأشهر المختلفة بسهولة."
    ],
    "evaluation-table": [
      "هنا تفاصيل جميع التقييمات، يمكنك الفرز والتصفية.",
      "اضغط على 'عرض' لرؤية تفاصيل أي تقييم.",
      "يمكنك تصدير البيانات لبرنامج Excel لمزيد من التحليل."
    ],
    "general": [
      "أنا بيلو، مساعدك الشخصي في نظام YLY!",
      "إزيك؟ عاوز تساعدك في أي حاجة؟",
      "التقارير دي بتساعدك تفهم أداء المتطوعين بشكل أفضل",
      "متنساش تشوف التقييمات الشهرية لكل متطوع",
      "تقدر تصدر التقارير في ملف إكسل أو PDF بسهولة"
    ]
  };

  // تهيئة الصفحة
  document.addEventListener('DOMContentLoaded', function() {
    // تعيين بيانات المستخدم
    document.getElementById('dropdown-username').textContent = currentUser.name;
    document.getElementById('dropdown-userrole').textContent = currentUser.role;
    document.getElementById('season-number').textContent = currentUser.season;
    
    // إنشاء الجزيئات المتحركة
    createParticles();
    
    // إنشاء الرسوم البيانية
    createCharts();
    
    // إعداد تفاعلات الصفحة
    setupPageInteractions();
    
    // إعداد تفاعلات بيلو
    setupBiloInteractions();
    
    // تحميل المتطوعين المتميزين
    loadTopVolunteers();
  });

  // إنشاء الجزيئات المتحركة
  function createParticles() {
    const particlesContainer = document.getElementById('particles');
    const count = Math.floor(window.innerWidth / 20);
    
    for (let i = 0; i < count; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      
      const size = Math.random() * 5 + 2;
      const posX = Math.random() * window.innerWidth;
      const duration = Math.random() * 15 + 10;
      const delay = Math.random() * 10;
      const opacity = Math.random() * 0.5 + 0.3;
      
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      particle.style.left = `${posX}px`;
      particle.style.bottom = '0';
      particle.style.animationDuration = `${duration}s`;
      particle.style.animationDelay = `${delay}s`;
      particle.style.opacity = opacity;
      
      particlesContainer.appendChild(particle);
    }
  }

  // إنشاء الرسوم البيانية
  function createCharts() {
    // رسم بياني لتوزيع التقديرات
    const gradesCtx = document.getElementById('gradesChart').getContext('2d');
    new Chart(gradesCtx, {
      type: 'bar',
      data: {
        labels: evaluationData.grades.labels,
        datasets: [{
          label: 'عدد المتطوعين',
          data: evaluationData.grades.data,
          backgroundColor: [
            '#28a745',
            '#a3d56e',
            '#ffc107',
            '#ff9f43',
            '#dc3545'
          ],
          borderWidth: 1,
          borderColor: 'rgba(255,255,255,0.3)'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'top',
            rtl: true,
            labels: {
              font: {
                family: 'Cairo',
                size: 14
              },
              color: 'white'
            }
          },
          title: {
            display: true,
            text: 'توزيع المتطوعين حسب التقديرات',
            font: {
              size: 16,
              family: 'Cairo',
              weight: 'bold'
            },
            color: 'white',
            padding: {
              top: 10,
              bottom: 20
            }
          },
          tooltip: {
            titleFont: {
              family: 'Cairo',
              size: 14
            },
            bodyFont: {
              family: 'Cairo',
              size: 12
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              color: 'white',
              font: {
                family: 'Cairo',
                size: 12
              }
            },
            grid: {
              color: 'rgba(255,255,255,0.1)'
            }
          },
          x: {
            ticks: {
              color: 'white',
              font: {
                family: 'Cairo',
                size: 12
              }
            },
            grid: {
              color: 'rgba(255,255,255,0.1)'
            }
          }
        }
      }
    });

    // رسم بياني لمتوسط التقييمات
    const trendCtx = document.getElementById('trendChart').getContext('2d');
    new Chart(trendCtx, {
      type: 'line',
      data: {
        labels: evaluationData.trend.labels,
        datasets: [{
          label: 'متوسط التقييم',
          data: evaluationData.trend.averages,
          borderColor: '#57C5B6',
          backgroundColor: 'rgba(87, 197, 182, 0.1)',
          borderWidth: 3,
          pointBackgroundColor: '#57C5B6',
          pointRadius: 5,
          pointHoverRadius: 7,
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'top',
            rtl: true,
            labels: {
              font: {
                family: 'Cairo',
                size: 14
              },
              color: 'white'
            }
          },
          title: {
            display: true,
            text: 'تطور متوسط التقييمات خلال الأشهر الأخيرة',
            font: {
              size: 16,
              family: 'Cairo',
              weight: 'bold'
            },
            color: 'white',
            padding: {
              top: 10,
              bottom: 20
            }
          },
          tooltip: {
            titleFont: {
              family: 'Cairo',
              size: 14
            },
            bodyFont: {
              family: 'Cairo',
              size: 12
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            min: 70,
            max: 90,
            ticks: {
              color: 'white',
              font: {
                family: 'Cairo',
                size: 12
              }
            },
            grid: {
              color: 'rgba(255,255,255,0.1)'
            }
          },
          x: {
            ticks: {
              color: 'white',
              font: {
                family: 'Cairo',
                size: 12
              }
            },
            grid: {
              color: 'rgba(255,255,255,0.1)'
            }
          }
        }
      }
    });
  }

  // إعداد تفاعلات الصفحة
  function setupPageInteractions() {
    // عرض/إخفاء قائمة المستخدم
    document.getElementById('user-avatar').addEventListener('click', function() {
      document.getElementById('user-dropdown').classList.toggle('show');
    });

    // إغلاق القائمة عند النقر خارجها
    window.addEventListener('click', function(e) {
      if (!e.target.matches('#user-avatar') && !e.target.matches('#user-avatar *')) {
        const dropdown = document.getElementById('user-dropdown');
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
        }
      }
    });

    // عرض رسالة بيلو عند تحميل الصفحة
    setTimeout(() => {
      showBiloMessage("مرحباً بك في قسم التقارير! هنا يمكنك تحليل أداء المتطوعين واتخاذ قرارات مدروسة.");
    }, 1000);
    
    // إعداد زر مسح البحث
    document.getElementById('search-clear').addEventListener('click', function() {
      document.getElementById('search-input').value = '';
      this.style.display = 'none';
      searchTable('');
    });
    
    // إعداد حقل البحث
    document.getElementById('search-input').addEventListener('input', function() {
      searchTable(this.value.toLowerCase());
    });
  }

  // إعداد تفاعلات بيلو
  function setupBiloInteractions() {
    // عناصر الصفحة التي سيتفاعل معها بيلو
    const interactiveElements = [
      { id: 'main-section-title', key: 'main-section' },
      { id: 'total-evaluations-card', key: 'total-evaluations' },
      { id: 'average-score-card', key: 'average-score' },
      { id: 'highest-score-card', key: 'highest-score' },
      { id: 'top-volunteers-card', key: 'top-volunteers' },
      { id: 'report-filters', key: 'report-filters' },
      { id: 'search-box', key: 'search-box' },
      { id: 'grades-chart-container', key: 'grades-chart' },
      { id: 'trend-chart-container', key: 'trend-chart' },
      { id: 'evaluation-table', key: 'evaluation-table' }
    ];
    
    // إضافة تفاعلات لكل عنصر
    interactiveElements.forEach(element => {
      const el = document.getElementById(element.id);
      if (el) {
        // عند تحويل المؤشر
        el.addEventListener('mouseenter', () => {
          const messages = biloMessages[element.key] || biloMessages.general;
          const randomMsg = messages[Math.floor(Math.random() * messages.length)];
          showBiloMessage(randomMsg);
        });
        
        // عند النقر
        el.addEventListener('click', () => {
          const messages = biloMessages[element.key] || biloMessages.general;
          const randomMsg = messages[Math.floor(Math.random() * messages.length)];
          showBiloMessage(randomMsg);
        });
      }
    });
    
    // تفاعل بيلو الرئيسي
    const biloImg = document.getElementById('bilo-img');
    biloImg.addEventListener('click', function() {
      const messages = biloMessages.general;
      const randomMsg = messages[Math.floor(Math.random() * messages.length)];
      showBiloMessage(randomMsg);
    });
  }

  // تحميل المتطوعين المتميزين
  function loadTopVolunteers() {
    const container = document.getElementById('top-volunteers-list');
    container.innerHTML = '';
    
    topVolunteers.forEach((volunteer, index) => {
      const card = document.createElement('div');
      card.className = 'top-volunteer-card';
      card.innerHTML = `
        <img src="${volunteer.avatar}" alt="صورة ${volunteer.name}" class="top-volunteer-avatar">
        <div class="top-volunteer-details">
          <h4>${index + 1}. ${volunteer.name}</h4>
          <p>${volunteer.committeeName} (${volunteer.committee})</p>
          <p>التقييم: <span class="top-volunteer-score">${volunteer.score}/100</span></p>
        </div>
      `;
      
      // إضافة حدث النقر لرؤية التفاصيل
      card.addEventListener('click', () => {
        showEvaluationDetails(volunteer.id);
      });
      
      container.appendChild(card);
    });
  }

  // عرض رسالة بيلو
  let biloMessageTimeout;
  function showBiloMessage(message) {
    const biloImg = document.getElementById('bilo-img');
    const speech = document.getElementById('bilo-speech');
    
    speech.textContent = message;
    speech.classList.add('show');
    
    // إلغاء المؤقت السابق إذا كان موجوداً
    if (biloMessageTimeout) {
      clearTimeout(biloMessageTimeout);
    }
    
    // إخفاء الرسالة تلقائياً بعد 7 ثواني
    biloMessageTimeout = setTimeout(() => {
      speech.classList.remove('show');
    }, 7000);
  }

  // البحث في الجدول
  function searchTable(input) {
    const rows = document.querySelectorAll('#evaluation-table tbody tr');
    const searchClear = document.getElementById('search-clear');
    
    // عرض/إخفاء زر المسح
    searchClear.style.display = input ? 'block' : 'none';
    
    rows.forEach(row => {
      const name = row.cells[1].textContent.toLowerCase();
      const committee = row.cells[2].textContent.toLowerCase();
      
      if (name.includes(input) || committee.includes(input)) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    });
  }

  // عرض تفاصيل التقييم
  function showEvaluationDetails(id) {
    const evaluation = evaluationsDetails[id];
    if (!evaluation) return;
    
    // تعبئة البيانات في النافذة المنبثقة
    document.getElementById('modal-volunteer-name').textContent = evaluation.name;
    document.getElementById('modal-avatar').src = evaluation.avatar;
    document.getElementById('modal-committee').textContent = `اللجنة: ${evaluation.committee}`;
    document.getElementById('modal-evaluation-month').textContent = `شهر التقييم: ${evaluation.month}`;
    document.getElementById('modal-total-score').textContent = evaluation.total;
    document.getElementById('modal-grade').textContent = evaluation.grade;
    document.getElementById('modal-tasks').textContent = evaluation.tasks;
    document.getElementById('modal-events').textContent = evaluation.events;
    document.getElementById('modal-meetings').textContent = evaluation.meetings;
    document.getElementById('modal-punctuality').textContent = evaluation.punctuality;
    document.getElementById('modal-teamwork').textContent = evaluation.teamwork;
    document.getElementById('modal-creativity').textContent = evaluation.creativity;
    document.getElementById('modal-comments').textContent = evaluation.comments;
    
    // إظهار النافذة المنبثقة
    document.getElementById('evaluation-modal').classList.add('show');
    
    // عرض رسالة بيلو
    showBiloMessage(`تفاصيل تقييم ${evaluation.name} - ${evaluation.committee}\nالتقدير: ${evaluation.grade}`);
  }

  // إغلاق تفاصيل التقييم
  function closeEvaluationDetails() {
    document.getElementById('evaluation-modal').classList.remove('show');
  }

  // عرض نافذة أعلى تقييم
  function showTopEvaluation() {
    document.getElementById('top-evaluation-modal').classList.add('show');
    showBiloMessage("مبروك لريم عاشور على تحقيق أعلى تقييم في النظام! يمكنك إرسال رسالة شكر لها من خلال هذا النموذج.");
  }

  // إغلاق نافذة أعلى تقييم
  function closeTopEvaluation() {
    document.getElementById('top-evaluation-modal').classList.remove('show');
  }

  // عرض نافذة المتطوعين المتميزين
  function showTopVolunteers() {
    document.getElementById('top-volunteers-modal').classList.add('show');
    showBiloMessage("هذه قائمة المتطوعين المتميزين الذين حصلوا على تقدير ممتاز. يمكنك تهنئتهم جميعاً بنقرة واحدة!");
  }

  // إغلاق نافذة المتطوعين المتميزين
  function closeTopVolunteers() {
    document.getElementById('top-volunteers-modal').classList.remove('show');
  }

  // إرسال رسالة شكر من بيلو عبر واتساب
  function sendThankYouMessage() {
    const volunteerName = "ريم عاشور";
    const committee = "العلاقات العامة (PR)";
    const score = "98/100";
    const month = "فبراير 2025";
    
    const message = `🎉 *مبروك يا ${volunteerName}!* 🎉\n\nأنت صاحبة أعلى تقييم في نظام YLY لهذا الشهر!\n\n*التفاصيل:*\n- اللجنة: ${committee}\n- الشهر: ${month}\n- التقييم: ${score}\n\n*رسالة خاصة من بيلو:*\n"ألف مبروك على هذا الإنجاز الرائع! أداؤك المتميز كان مثالاً يحتذى به لجميع المتطوعين. استمري في هذا التميز، ونحن نقدر جهودك الكبيرة في لجنة العلاقات العامة."\n\nمع خالص التقدير،\nبيلو - مساعد نظام YLY`;
    
    const encodedMessage = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
    
    window.open(whatsappUrl, '_blank');
  }

  // إرسال تهنئة جماعية للمتطوعين المتميزين
  function sendGroupCongratulation() {
    const season = currentUser.season;
    const month = "فبراير 2025";
    
    let message = `🎉 *تهنئة جماعية للمتطوعين المتميزين* 🎉\n\n`;
    message += `مبروك لكم جميعاً على تحقيقكم تقدير ممتاز (A) في تقييمات شهر ${month} لموسم YLY ${season}!\n\n`;
    message += `*قائمة المتميزين هذا الشهر:*\n`;
    
    topVolunteers.forEach((volunteer, index) => {
      message += `${index + 1}. ${volunteer.name} - ${volunteer.committeeName} (${volunteer.score}/100)\n`;
    });
    
    message += `\n*رسالة خاصة من بيلو:*\n"أشكركم جميعاً على جهودكم المتميزة وتفانيكم في العمل. أنتم مثال يحتذى به لجميع المتطوعين، ونقدر لكم إسهاماتكم القيمة في نجاح هذا الموسم. استمروا في هذا التميز!"\n\n`;
    message += `مع خالص التقدير،\nبيلو - مساعد نظام YLY`;
    
    const encodedMessage = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
    
    window.open(whatsappUrl, '_blank');
  }

  // مشاركة التقييم عبر واتساب
  function shareOnWhatsApp() {
    const name = document.getElementById('modal-volunteer-name').textContent;
    const committee = document.getElementById('modal-committee').textContent;
    const month = document.getElementById('modal-evaluation-month').textContent;
    const total = document.getElementById('modal-total-score').textContent;
    const grade = document.getElementById('modal-grade').textContent;
    
    const text = `تقييم المتطوع ${name}\n${committee}\n${month}\n\nالمجموع الكلي: ${total}\nالتقدير: ${grade}\n\nتم التقييم عبر نظام YLY`;
    const encodedText = encodeURIComponent(text);
    const url = `https://wa.me/?text=${encodedText}`;
    
    window.open(url, '_blank');
  }

  // طباعة التقييم
  function printEvaluation() {
    // يمكن تطوير هذه الوظيفة لطباعة التقييم بشكل أفضل
    window.print();
  }

  // تبديل اللغة
  function toggleLanguage() {
    const currentLang = document.documentElement.lang;
    if (currentLang === 'ar') {
      document.documentElement.lang = 'en';
      document.documentElement.dir = 'ltr';
      document.querySelector('.language-toggle span').textContent = 'English / العربية';
      document.title = 'Evaluation Reports | YLY';
    } else {
      document.documentElement.lang = 'ar';
      document.documentElement.dir = 'rtl';
      document.querySelector('.language-toggle span').textContent = 'العربية / English';
      document.title = 'تقارير التقييمات | YLY';
    }
  }

  // تسجيل الخروج
  function logout() {
    window.location.href = 'login.html';
  }

  // فتح الإعدادات
  function openSettings() {
    window.location.href = 'settings.html';
  }
</script>
</body>
</html>